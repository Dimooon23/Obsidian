Asciinema : Se reinseigner

tr

cut -d: -f1,4 /etc/passwd

LVM :
![[LVM02.png]]
SWAP : Extension de la ram

xterm
gnome

# Activité 4

Voici une version améliorée des commandes en utilisant des notations plus efficaces comme les accolades (`{}`) pour générer des séquences et d'autres techniques plus concises :

## Exercices 1-5: Gestion des fichiers et droits d'accès

**Exercice 1: Création de fichiers**

```bash
# Création des fichiers avec notation par accolades
touch ~/file{1..3}

# Vérification des droits par défaut
ls -l ~/file{1..3}
```

**Exercice 2: Assignation des droits (forme littérale)**

```bash
chmod u=rwx,go= ~/file1
chmod u=r,g=r,o= ~/file2
chmod u=r,g=,o=x ~/file3

# Vérification plus concise
ls -l ~/file{1..3}
```

**Exercice 3: Assignation des droits (forme octale)**

```bash
chmod 501 ~/file1  # r-x-----x
chmod 222 ~/file2  # -w--w--w-
chmod 061 ~/file3  # ---rwx--x

# Vérification
ls -l ~/file{1..3}
```

**Exercice 4: Tests d'écriture**

```bash
echo "test" > ~/file1
echo "test" > ~/file2
echo "test" > ~/file3 2> /dev/null  # Redirige les erreurs pour un affichage plus propre
```

**Exercice 5: Autres droits et copie**

```bash
# Assignation simultanée des droits avec différentes permissions
chmod 000 ~/file1
chmod 400 ~/file2
chmod 600 ~/file3

# Tests de copie
cp ~/file1 ~/file4 2> /dev/null
cp ~/file2 ~/file5 && ls -l ~/file5

# Suppression avec une seule commande
rm -f ~/file{1..5}  # -f pour forcer sans prompt
```

## Exercices 6-12: Droits sur les répertoires

**Exercice 6: Création et manipulation de répertoire**

```bash
mkdir -p ~/test
chmod 700 ~/test

# Création de plusieurs fichiers en une seule commande
cd ~/test
touch file{1,2,5,6,7} testdroit.txt

# Vérification et test
ls -l
echo "texte de test" > testdroit.txt
rm -f file1
```

**Exercice 7-12: Modification séquentielle des droits du répertoire**

```bash
# Exercice 7: drw-------
cd ~
chmod 600 ~/test
ls -la ~/test
touch ~/test/testdroit1.txt
rm -f ~/test/file2

# Exercice 8: d-w-------
chmod 200 ~/test
ls -la ~/test 2> /dev/null

# Exercice 9: dr--------
chmod 400 ~/test
ls -la ~/test

# Exercice 10: dr-x------
chmod 500 ~/test
ls -la ~/test
touch ~/test/testdroit5.txt 2> /dev/null
echo "test" > ~/test/file5 2> /dev/null
rm -f ~/test/file5 2> /dev/null

# Exercice 11: d--x------
chmod 100 ~/test
ls -la ~/test 2> /dev/null
touch ~/test/testdroit6.txt 2> /dev/null
echo "test" > ~/test/file6 2> /dev/null
rm -f ~/test/file6 2> /dev/null

# Exercice 12: d-wx------
chmod 300 ~/test
ls -la ~/test 2> /dev/null
touch ~/test/testdroit7.txt 2> /dev/null
echo "test" > ~/test/file7 2> /dev/null
rm -f ~/test/file7 2> /dev/null
```

## Exercice 13-14: Création d'un répertoire sécurisé

```bash
# Création du répertoire et des fichiers en une seule commande
mkdir -p ~/test_sec
touch ~/test_sec/file{1..5}.txt

# Configuration des droits pour différents scénarios - regroupements efficaces
# 1. Permettre aux membres du groupe de lire le contenu des fichiers
chmod 640 ~/test_sec/*.txt

# 2. Lister les fichiers sans lire leur contenu
chmod 750 ~/test_sec
chmod 600 ~/test_sec/*.txt

# 3. Lire le contenu d'un fichier connu sans lister les fichiers
chmod 710 ~/test_sec
chmod 640 ~/test_sec/*.txt

# 4. Modifier un fichier existant
chmod 660 ~/test_sec/*.txt

# 5. Ajouter et effacer un fichier
chmod 770 ~/test_sec
```

## Application des permissions (dernière partie)

Pour configurer l'arborescence avec les droits d'accès spécifiés:

```bash
# Création de l'arborescence complète en peu de commandes
mkdir -p ~/pier/{d1,d2}
touch ~/pier/d1/f{1..5}.txt ~/pier/d2/f{1..5}.txt

# Configuration des droits de base puis spécifiques
# Retirer tous les droits d'abord
chmod 700 ~/pier
chmod -R 000 ~/pier/*  # Récursivement retirer tous les droits

# Ajouter les droits spécifiques
chmod 750 ~/pier/d1     # rwxr-x--- (lecture et traversée pour le groupe)
chmod 640 ~/pier/d1/*.txt  # rw-r----- (lecture pour le groupe)

chmod 770 ~/pier/d2     # rwxrwx--- (lecture/écriture/traversée pour le groupe)
chmod 660 ~/pier/d2/*.txt  # rw-rw---- (lecture/écriture pour le groupe)

# Commande unique pour vérifier toute l'arborescence
find ~/pier -type d -exec ls -ld {} \; && find ~/pier -type f -exec ls -l {} \;
```

Instructions de test optimisées:

```bash
# Script pour tester tous les cas en tant qu'utilisateur du même groupe
# À exécuter par un utilisateur du même groupe que pier

# Test d1 (droits de lecture uniquement)
echo -e "\n=== Test d1 (droits de lecture uniquement) ==="
ls -la ~/pier/d1/
cat ~/pier/d1/f1.txt
touch ~/pier/d1/nouveaufichier.txt 2>&1 | grep -i "permission denied" && echo "OK - Création refusée comme prévu"

# Test d2 (droits de lecture, écriture, exécution)
echo -e "\n=== Test d2 (droits de lecture, modification, ajout) ==="
ls -la ~/pier/d2/
cat ~/pier/d2/f1.txt
echo "Modification" >> ~/pier/d2/f1.txt && echo "OK - Modification réussie comme prévu"
touch ~/pier/d2/nouveaufichier.txt && echo "OK - Création réussie comme prévu"
rm ~/pier/d2/nouveaufichier.txt && echo "OK - Suppression réussie comme prévu"
```

Ces commandes optimisées utilisent les techniques suivantes:

- Expansion par accolades (`file{1..3}`, `{d1,d2}`) pour générer des séquences
- Opérations groupées sur des ensembles de fichiers
- Redirection des erreurs (`2> /dev/null`) pour un output plus propre
- Commandes avec options plus efficaces (`mkdir -p`, `chmod -R`)
- Utilisation de `find` pour des opérations récursives
- Script de test compact pour vérifier tous les cas d'utilisation