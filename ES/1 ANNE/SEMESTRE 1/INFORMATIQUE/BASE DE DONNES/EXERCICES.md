```SQL title:EX003.sql
-- 1
SELECT COUNT(*) 
FROM PERSONNES
WHERE LANGUE = 'FRANCAIS'
AND COULEUR_YEUX NOT IN ('BLEUM', 'VERT', 'GRIS');

-- 2
SELECT AVG(SALAIRE_HORAIRE * 8)
FROM PERSONNES
INNER JOIN PROFESSIONS ON (PROFESSIONS.CODE = PERSONNES.FK1_PERSONNES_PROFESSION)
WHERE SEXE = 'M';

-- 3
SELECT NOM, COUNT(*)
FROM PERSONNES
GROUP BY NOM;

-- 4
SELECT SUM(SALAIRE_HORAIRE * 8)
FROM PERSONNES
INNER JOIN PROFESSIONS ON (PROFESSIONS.CODE = PERSONNES.FK1_PERSONNES_PROFESSION)
WHERE DATE_NAISSANCE < TO_DATE('01.01.1995','DD.MM.YYYY');

-- 5
SELECT VILLE, COUNT(*)
FROM PERSONNES
INNER JOIN PROFESSIONS ON (PROFESSIONS.CODE = PERSONNES.FK1_PERSONNES_PROFESSION)
WHERE SALAIRE_HORAIRE > 30
GROUP BY VILLE;

-- 6 
SELECT LANGUE, AVG(SALAIRE_HORAIRE)
FROM PERSONNES
INNER JOIN PROFESSIONS ON (PROFESSIONS.CODE = PERSONNES.FK1_PERSONNES_PROFESSION)
WHERE LANGUE IN ('ANGLAIS', 'FRANCAIS')
GROUP BY LANGUE;

-- 7
SELECT VILLE, COUNT(*)
FROM PERSONNES
GROUP BY VILLE
HAVING COUNT(*) > 40;

-- 8
SELECT PROVINCE, COUNT(*)
FROM PERSONNES
INNER JOIN PROFESSIONS ON (PROFESSIONS.CODE = PERSONNES.FK1_PERSONNES_PROFESSION)
WHERE SALAIRE_HORAIRE*8 >= 200
AND SEXE = 'F'
GROUP BY PROVINCE;

-- 9
SELECT NOM, PRENOM, DATE_NAISSANCE, EXTRACT('YEAR' FROM NOW())- EXTRACT('YEAR' FROM DATE_NAISSANCE) AS AGE
FROM PERSONNES
WHERE EXTRACT('YEAR' FROM DATE_NAISSANCE) = 1955;

-- 10
SELECT NOM, PRENOM, DATE_NAISSANCE
FROM PERSONNES
WHERE EXTRACT('MONTH' FROM CURRENT_DATE + INTERVAL '1 month') = EXTRACT('MONTH' FROM DATE_NAISSANCE);
```

```SQL title:EX004.sql
-- 1
SELECT LOCALITE, COUNT(*) AS NB
FROM CLIENTS
GROUP BY LOCALITE
ORDER BY NB DESC;

-- 2
SELECT UUID, NOM
FROM ARTICLES A
INNER JOIN LIGNES_COMMANDES LC ON (LC.ARTICLES_UUID = A.UUID)
WHERE A.PRIX_VENTE < LC.PRIX_VENTE_REEL;

-- 3


-- 4
-- 5
-- 6
-- 7
-- 8
-- 9
-- 10
-- 11
-- 12
-- 13
-- 14
-- 15
```

```SQL title:EX005.sql
-- 1
SELECT M.UUID, COUNT(L.UUID) AS NB_L
FROM MAGASINS M
INNER JOIN LIVRAISONS L ON (M.UUID = L.MAGASINS_UUID)
GROUP BY M.UUID

SELECT M.UUID
FROM MAGASINS M
WHERE COALESCE((SELECT COUNT(*) FROM LIVRAISONS L WHERE L.MAGASINS_UUID = M.UUID),0) > 0;

--SOLUTION(JUSTE DE FAIRE INNER JOIN)

-- 2
SELECT M.UUID, C.UUID
FROM MAGASINS M
LEFT JOIN COMMANDES C ON (M.UUID = C.MAGASINS_UUID)
WHERE C.UUID IS NULL;

-- 3
SELECT CL.UUID, C.CLIENTS_UUID
FROM CLIENTS CL
LEFT JOIN COMMANDES C ON (C.CLIENTS_UUID = CL.UUID)
WHERE C.CLIENTS_UUID IS NULL

SELECT CL.UUID
FROM CLIENTS CL
WHERE NOT EXISTS (SELECT CLIENTS_UUID FROM COMMANDES WHERE CL.UUID = CLIENTS_UUID);

-- 4


-- 5
-- 6
-- 7
-- 8
-- 9
-- 10
-- 11
-- 12
--Afficher le nombre de commandes partiellement livrÃ©es.
SELECT COUNT(UUID)
FROM(
	SELECT A.UUID, SUM(LC.QTE_COMMANDEE) AS QTECOMM, SUM(LL.QTE_LIVREE) AS QTELIVRE
	FROM ARTICLES A
	INNER JOIN LIGNES_COMMANDES AS LC ON (LC.ARTICLES_UUID = A.UUID)
	INNER JOIN LIGNES_LIVRAISONS AS LL ON (LL.LIVRAISONS_UUID = LC.COMMANDES_UUID)
	GROUP BY A.UUID
) AS TEMP
WHERE QTECOMM - QTELIVRE > 0;


-- 13
-- 14
-- 15
```